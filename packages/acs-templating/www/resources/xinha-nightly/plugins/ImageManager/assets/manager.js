/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
/* This file is part of version 0.96beta2 released Fri, 20 Mar 2009 11:01:14 +0100 */
function i18n(a){return Xinha._lc(a,"ImageManager")}function setAlign(c){var b=document.getElementById("f_align");for(var a=0;a<b.length;a++){if(b.options[a].value==c){b.selectedIndex=a;break}}}doneinit=0;init=function(){if(doneinit++){return}__dlg_init(null,{width:600,height:460});__dlg_translate("ImageManager");document.getElementById("f_align").selectedIndex=1;document.getElementById("f_align").selectedIndex=0;var g=document.getElementById("uploadForm");if(g){g.target="imgManager"}var c=window.dialogArguments;if(c){var f=new RegExp("(https?://[^/]*)?"+base_url.replace(/\/$/,""));c.f_url=c.f_url.replace(f,"");var j=(_resized_dir)?_resized_dir.replace(Xinha.RE_Specials,"\\$1")+"/":"";var e=_resized_prefix.replace(Xinha.RE_Specials,"\\$1");var a=new RegExp("^(.*/)"+j+e+"_([0-9]+)x([0-9]+)_([^/]+)$");if(a.test(c.f_url)){c.f_url=RegExp.$1+RegExp.$4;c.f_width=RegExp.$2;c.f_height=RegExp.$3}for(var b in c){if(b=="f_align"){continue}if(document.getElementById(b)){document.getElementById(b).value=c[b]}}document.getElementById("orginal_width").value=c.f_width;document.getElementById("orginal_height").value=c.f_height;setAlign(c.f_align);var a=new RegExp("^(.*/)([^/]+)$");if(a.test(c.f_url)&&!(new RegExp("^https?://","i")).test(c.f_url)){changeDir(RegExp.$1);var h=document.getElementById("dirPath");for(var d=0;d<h.options.length;d++){if(h.options[d].value==encodeURIComponent(RegExp.$1)){h.options[d].selected=true;break}}}document.getElementById("f_preview").src=_backend_url+"__function=thumbs&img="+c.f_url}new Xinha.colorPicker.InputBinding(document.getElementById("f_backgroundColor"));new Xinha.colorPicker.InputBinding(document.getElementById("f_borderColor"));document.getElementById("f_alt").focus()};function onCancel(){__dlg_close(null);return false}function onOK(){var fields=["f_url","f_alt","f_align","f_width","f_height","f_padding","f_margin","f_border","f_borderColor","f_backgroundColor"];var param=new Object();for(var i in fields){var id=fields[i];var el=document.getElementById(id);if(id=="f_url"&&el.value.indexOf("://")<0){if(el.value==""){alert(i18n("No Image selected."));return(false)}param[id]=makeURL(base_url,el.value)}else{if(el){param[id]=el.value}else{alert("Missing "+fields[i])}}}var origsize={w:document.getElementById("orginal_width").value,h:document.getElementById("orginal_height").value};if((origsize.w!=param.f_width)||(origsize.h!=param.f_height)){var resized=Xinha._geturlcontent(_backend_url+"&__function=resizer&img="+encodeURIComponent(document.getElementById("f_url").value)+"&width="+param.f_width+"&height="+param.f_height);resized=eval(resized);if(resized){param.f_url=makeURL(base_url,resized)}}__dlg_close(param);return false}function makeURL(b,a){if(b.substring(b.length-1)!="/"){b+="/"}if(a.charAt(0)=="/"){}a=a.substring(1);return b+a}function updateDir(a){var b=a.options[a.selectedIndex].value;changeDir(b)}function goUpDir(){var d=document.getElementById("dirPath");var g=d.options[d.selectedIndex].text;if(g.length<2){return false}var f=g.split("/");var c="";for(var b=0;b<f.length-2;b++){c+=f[b]+"/"}for(var b=0;b<d.length;b++){var a=d.options[b].text;if(a==c){d.selectedIndex=b;var e=d.options[b].value;changeDir(e);break}}}function changeDir(a){if(typeof imgManager!="undefined"){imgManager.changeDir(a)}}function toggleConstrains(b){var a=document.getElementById("imgLock");var b=document.getElementById("constrain_prop");if(b.checked){a.src="img/locked.gif";checkConstrains("width")}else{a.src="img/unlocked.gif"}}function checkConstrains(d){var c=document.getElementById("constrain_prop");if(c.checked){var e=document.getElementById("orginal_width");var b=parseInt(e.value);var e=document.getElementById("orginal_height");var f=parseInt(e.value);var g=document.getElementById("f_width");var h=document.getElementById("f_height");var a=parseInt(g.value);var i=parseInt(h.value);if(b>0&&f>0){if(d=="width"&&a>0){h.value=parseInt((a/b)*f)}if(d=="height"&&i>0){g.value=parseInt((i/f)*b)}}}}function showMessage(a){var c=document.getElementById("message");var b=document.getElementById("messages");if(c.firstChild){c.removeChild(c.firstChild)}c.appendChild(document.createTextNode(i18n(a)));b.style.display=""}function addEvent(d,c,a){if(d.addEventListener){d.addEventListener(c,a,true);return true}else{if(d.attachEvent){var b=d.attachEvent("on"+c,a);return b}else{return false}}}function doUpload(){var a=document.getElementById("uploadForm");if(a){showMessage("Uploading")}}function refresh(){var a=document.getElementById("dirPath");updateDir(a)}function newFolder(){function a(e){var d=document.getElementById("dirPath");var c=d.options[d.selectedIndex].value;if(e==thumbdir){alert(i18n("Invalid folder name, please choose another folder name."));return false}if(e&&e!=""&&typeof imgManager!="undefined"){imgManager.newFolder(c,encodeURI(e))}}if(Xinha.ie_version>6){Dialog("newFolder.html",function(d){if(!d){return false}else{var c=d.f_foldername;a(c)}},null)}else{var b=prompt(i18n("Please enter name for new folder..."),i18n("Untitled"));a(b)}}addEvent(window,"load",init);